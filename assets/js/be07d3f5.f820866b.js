"use strict";(self.webpackChunkflecks_docusaurus=self.webpackChunkflecks_docusaurus||[]).push([[1204],{1538:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>c,contentTitle:()=>o,default:()=>h,frontMatter:()=>r,metadata:()=>t,toc:()=>a});var l=n(5893),i=n(1151);const r={title:"Creating a fleck",description:"A fleck is a module but also so much more."},o=void 0,t={id:"creating-a-fleck",title:"Creating a fleck",description:"A fleck is a module but also so much more.",source:"@site/docs/creating-a-fleck.mdx",sourceDirName:".",slug:"/creating-a-fleck",permalink:"/flecks/docs/creating-a-fleck",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{title:"Creating a fleck",description:"A fleck is a module but also so much more."},sidebar:"flecksSidebar",previous:{title:"Configuration",permalink:"/flecks/docs/configuration"},next:{title:"Compilation",permalink:"/flecks/docs/compilation"}},c={},a=[{value:"Your first fleck",id:"your-first-fleck",level:2},{value:"Create the fleck",id:"create-the-fleck",level:3},{value:"Aliasing for the win",id:"aliasing-for-the-win",level:3},{value:"Your first hook",id:"your-first-hook",level:3},{value:"flecks injection",id:"flecks-injection",level:3}];function d(e){const s={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.a)(),...e.components},{Details:n}=s;return n||function(e,s){throw new Error("Expected "+(s?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(s.p,{children:["If you are following along from the previous getting started\n",(0,l.jsx)(s.a,{href:"./configuration",children:"configuration page"}),", you have an application with 3 flecks:"]}),"\n",(0,l.jsxs)(s.ul,{children:["\n",(0,l.jsx)(s.li,{children:(0,l.jsx)(s.code,{children:"@flecks/build"})}),"\n",(0,l.jsx)(s.li,{children:(0,l.jsx)(s.code,{children:"@flecks/core"})}),"\n",(0,l.jsx)(s.li,{children:(0,l.jsx)(s.code,{children:"@flecks/server"})}),"\n"]}),"\n",(0,l.jsxs)(n,{children:[(0,l.jsx)("summary",{children:'About that "3 flecks" thing...'}),(0,l.jsxs)(s.p,{children:["Actually, your server application has ",(0,l.jsx)(s.strong,{children:"5 flecks"})," at this point:"]}),(0,l.jsxs)(s.ul,{children:["\n",(0,l.jsx)(s.li,{children:(0,l.jsx)(s.code,{children:"@flecks/build"})}),"\n",(0,l.jsx)(s.li,{children:(0,l.jsx)(s.code,{children:"@flecks/build/server"})}),"\n",(0,l.jsx)(s.li,{children:(0,l.jsx)(s.code,{children:"@flecks/core"})}),"\n",(0,l.jsx)(s.li,{children:(0,l.jsx)(s.code,{children:"@flecks/core/server"})}),"\n",(0,l.jsx)(s.li,{children:(0,l.jsx)(s.code,{children:"@flecks/server"})}),"\n"]}),(0,l.jsxs)(s.p,{children:["flecks will load the ",(0,l.jsx)(s.code,{children:"[...]/server"})," fleck under any fleck that is loaded on the server. This is\nalso the case when using ",(0,l.jsx)(s.code,{children:"@flecks/web"})," which will automatically load ",(0,l.jsx)(s.code,{children:"[...]/client"})," flecks\nwhich are only loaded in the browser."]})]}),"\n",(0,l.jsx)(s.h2,{id:"your-first-fleck",children:"Your first fleck"}),"\n",(0,l.jsxs)(s.p,{children:["Let's make your website greet the user with a good ol' ",(0,l.jsx)(s.strong,{children:"hello world"}),"."]}),"\n",(0,l.jsx)(s.p,{children:"To do this, you'll be creating your own little fleck. flecks also provides a built-in utility to\ncreate a fleck."}),"\n",(0,l.jsxs)(s.admonition,{title:"Your application is a monorepo by default",type:"note",children:[(0,l.jsxs)(s.p,{children:["You may have noticed that your little starter application has a ",(0,l.jsx)(s.code,{children:"packages"})," directory. By default,\nflecks structures your application as a monorepo."]}),(0,l.jsx)(s.p,{children:"This isn't any hard requirement, it's only a suggestion."})]}),"\n",(0,l.jsx)(s.h3,{id:"create-the-fleck",children:"Create the fleck"}),"\n",(0,l.jsx)(s.p,{children:"Let's create our little fleck:"}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-bash",children:"npx create-fleck say-hello\n"})}),"\n",(0,l.jsxs)(s.p,{children:["After some output, you'll find your new fleck at ",(0,l.jsx)(s.code,{children:"packages/say-hello"}),". Let's inspect our\n",(0,l.jsx)(s.code,{children:"build/flecks.yml"}),":"]}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-yml",metastring:'title="build/flecks.yml"',children:"'@flecks/build': {}\n'@flecks/core':\n  id: 'hello-world'\n'@flecks/server': {}\n// highlight-next-line\n'@hello-world/say-hello:./packages/say-hello': {}\n"})}),"\n",(0,l.jsx)(s.h3,{id:"aliasing-for-the-win",children:"Aliasing for the win"}),"\n",(0,l.jsx)(s.p,{children:"Notice there's a colon separating the path for this one. This is because this is an aliased fleck.\nThe part before the colon is the alias and the part after is the path to the package."}),"\n",(0,l.jsxs)(s.p,{children:["By the way, your other application code can import using the alias (e.g.\n",(0,l.jsx)(s.code,{children:"require('@hello-world/say-hello');"}),")\n",(0,l.jsx)(s.a,{href:"https://webpack.js.org/configuration/resolve/#resolvealias",children:"as if it were a package"}),"."]}),"\n",(0,l.jsxs)(n,{children:[(0,l.jsxs)("summary",{children:["Wait, my modules don't have to be in ",(0,l.jsx)("code",{children:"node_modules"}),"?"]}),(0,l.jsx)(s.p,{children:'Nope! When you\'re developing applications, it can be real nice to\njust pull in local source "packages".'}),(0,l.jsx)(s.p,{children:"That being said, sharing your packages on npm is a cool thing to do, so be rad and share your\nawesome flecks with the rest of us!"})]}),"\n",(0,l.jsx)(s.h3,{id:"your-first-hook",children:"Your first hook"}),"\n",(0,l.jsxs)(s.p,{children:["There is a source file at ",(0,l.jsx)(s.code,{children:"packages/say-hello/src/index.js"})," but for now it's empty. Let's fill it\nout a bit:"]}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-javascript",metastring:'title="packages/say-hello/src/index.js"',children:"export const hooks = {\n  '@flecks/server.up': async () => {\n    process.stdout.write('  hello server\\n');\n  },\n};\n"})}),"\n",(0,l.jsx)(s.p,{children:"Now, restart your application:"}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-bash",children:"npm run start\n"})}),"\n",(0,l.jsx)(s.p,{children:"You will be greeted by a line in the output:"}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-terminal",children:"  hello server\n"})}),"\n",(0,l.jsx)(s.h3,{id:"flecks-injection",children:"flecks injection"}),"\n",(0,l.jsxs)(s.p,{children:["Hook implementations may receive arguments. After any arguments, the ",(0,l.jsx)(s.code,{children:"flecks"})," instance is always\npassed."]}),"\n",(0,l.jsxs)(s.p,{children:[(0,l.jsx)(s.code,{children:"@flecks/server.up"})," doesn't pass any arguments, so the ",(0,l.jsx)(s.code,{children:"flecks"})," instance is the first argument.\nLet's see how to use the instance to read some configuration:"]}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-javascript",metastring:'title="packages/say-hello/src/index.js"',children:"export const hooks = {\n  '@flecks/server.up': async (flecks) => {\n    const {id} = flecks.get('@flecks/core');\n    process.stdout.write(`  hello server: ID ${id}\\n`);\n  },\n};\n"})}),"\n",(0,l.jsx)(s.p,{children:"This time, you will see:"}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-terminal",children:"  hello server: ID hello-world\n"})}),"\n",(0,l.jsx)(s.admonition,{title:"Still with us?",type:"note",children:(0,l.jsxs)(s.p,{children:["...or whatever your application's ID is. We're assuming you're following along from\n",(0,l.jsx)(s.a,{href:"./configuration",children:"the configuration page"}),"."]})}),"\n",(0,l.jsx)(s.p,{children:"Next, we'll go over some of the nuts and bolts of how your flecks are compiled."})]})}function h(e={}){const{wrapper:s}={...(0,i.a)(),...e.components};return s?(0,l.jsx)(s,{...e,children:(0,l.jsx)(d,{...e})}):d(e)}},1151:(e,s,n)=>{n.d(s,{Z:()=>t,a:()=>o});var l=n(7294);const i={},r=l.createContext(i);function o(e){const s=l.useContext(r);return l.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function t(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),l.createElement(r.Provider,{value:s},e.children)}}}]);