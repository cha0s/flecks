"use strict";(self.webpackChunkflecks_docusaurus=self.webpackChunkflecks_docusaurus||[]).push([[8532],{2343:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>d,contentTitle:()=>r,default:()=>h,frontMatter:()=>c,metadata:()=>i,toc:()=>l});var s=n(5893),a=n(1151);n(4866),n(5162);const c={title:"Sockets",description:"Run a websocket server and define packets."},r="Sockets",i={id:"sockets",title:"Sockets",description:"Run a websocket server and define packets.",source:"@site/docs/sockets.mdx",sourceDirName:".",slug:"/sockets",permalink:"/flecks/docs/sockets",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{title:"Sockets",description:"Run a websocket server and define packets."},sidebar:"flecksSidebar",previous:{title:"Docker",permalink:"/flecks/docs/docker"},next:{title:"React",permalink:"/flecks/docs/react"}},d={},l=[{value:"Packets",id:"packets",level:2},{value:"Packet hydration",id:"packet-hydration",level:3},{value:"SchemaPack",id:"schemapack",level:3},{value:"Data types",id:"data-types",level:4},{value:"Packer",id:"packer",level:3},{value:"The entire packet",id:"the-entire-packet",level:4},{value:"A specific key",id:"a-specific-key",level:4},{value:"Bundles",id:"bundles",level:3},{value:"Acceptors",id:"acceptors",level:3},{value:"<code>validate(packet, socket)</code>",id:"validatepacket-socket",level:4},{value:"<code>packet</code>",id:"packet",level:5},{value:"<code>socket</code>",id:"socket",level:5},{value:"<code>respond(packet, socket)</code>",id:"respondpacket-socket",level:4},{value:"<code>packet</code>",id:"packet-1",level:5},{value:"<code>socket</code>",id:"socket-1",level:5},{value:"Examples",id:"examples",level:4},{value:"Intercom",id:"intercom",level:2},{value:"<code>type</code>",id:"type",level:3},{value:"<code>data</code>",id:"data",level:3},{value:"Motivation",id:"motivation",level:3},{value:"Diagram",id:"diagram",level:3},{value:"Default packets",id:"default-packets",level:2},{value:"<code>Refresh</code>",id:"refresh",level:3},{value:"<code>Redirect</code>",id:"redirect",level:3}];function o(e){const t={a:"a",admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",li:"li",mermaid:"mermaid",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,a.a)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.h1,{id:"sockets",children:"Sockets"}),"\n",(0,s.jsxs)(t.p,{children:["flecks provides real-time socket connections through ",(0,s.jsx)(t.a,{href:"https://socket.io/docs/v4/",children:"Socket.IO"}),".\nPackets are binary by default so they are small and fast."]}),"\n",(0,s.jsx)(t.h2,{id:"packets",children:"Packets"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-javascript",metastring:'title="packages/example/src/index.js"',children:"import {Flecks} from '@flecks/core/server';\n\nexport const hooks = {\n  '@flecks/socket.packets': Flecks.provide(require.context('./packets')),\n}\n"})}),"\n",(0,s.jsx)(t.p,{children:"The simplest packet can be defined like so:"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-javascript",metastring:'title="packages/example/src/packets/slap.js"',children:"export default (flecks) => {\n  const {Packet} = flecks.fleck('@flecks/socket');\n  return class Slap extends Packet {};\n};\n"})}),"\n",(0,s.jsx)(t.p,{children:"This transmits no packet data at all, only the packet ID. e.g., you just know you've been\nslapped, since it's a slap packet. You don't know why, how hard, etc."}),"\n",(0,s.jsxs)(t.p,{children:["This is a ",(0,s.jsx)(t.strong,{children:"long-winded way"})," of sending a packet:"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-javascript",children:"const {Slap} = flecks.socket.Packets;\nsocket.send(new Slap());\n"})}),"\n",(0,s.jsxs)(t.p,{children:["but let's learn about ",(0,s.jsx)(t.strong,{children:"packet hydration"})," to make working with packets a lot easier."]}),"\n",(0,s.jsx)(t.h3,{id:"packet-hydration",children:"Packet hydration"}),"\n",(0,s.jsxs)(t.p,{children:["Instead of getting the packet class and having to manually create a new packet to send every time,\nwe can instead send a ",(0,s.jsx)(t.strong,{children:"dehydrated packet"}),":"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-javascript",children:"socket.send(['Slap']);\n"})}),"\n",(0,s.jsxs)(t.p,{children:["Notice that ",(0,s.jsx)(t.strong,{children:"a dehydrated packet is an array"}),". The first element of the array is the\n",(0,s.jsx)(t.a,{href:"./gathering",children:"gathered name"})," of the packet."]}),"\n",(0,s.jsx)(t.admonition,{title:"Move the payload!",type:"tip",children:(0,s.jsxs)(t.p,{children:["The second element is the ",(0,s.jsx)(t.code,{children:"data"})," passed to the packet constructor. We'll see a couple more\nexamples of sending dehydrated packets on this page to come."]})}),"\n",(0,s.jsxs)(t.p,{children:["Dehydrated sending is ",(0,s.jsx)(t.em,{children:"just better"})," and should always be preferred!"]}),"\n",(0,s.jsx)(t.h3,{id:"schemapack",children:"SchemaPack"}),"\n",(0,s.jsxs)(t.p,{children:["Packets may implement a static getter method ",(0,s.jsx)(t.code,{children:"data"})," to define the schema with which to serialize the\npacket data. See ",(0,s.jsx)(t.a,{href:"https://github.com/phretaddin/schemapack",children:"SchemaPack"}),"\nto learn more."]}),"\n",(0,s.jsx)(t.h4,{id:"data-types",children:"Data types"}),"\n",(0,s.jsxs)(t.table,{children:[(0,s.jsx)(t.thead,{children:(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.th,{children:"Type Name"}),(0,s.jsx)(t.th,{children:"Bytes"}),(0,s.jsx)(t.th,{children:"Range of Values"})]})}),(0,s.jsxs)(t.tbody,{children:[(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"bool"}),(0,s.jsx)(t.td,{children:"1"}),(0,s.jsxs)(t.td,{children:[(0,s.jsx)(t.code,{children:"true"})," or ",(0,s.jsx)(t.code,{children:"false"})]})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"int8"}),(0,s.jsx)(t.td,{children:"1"}),(0,s.jsx)(t.td,{children:"-128 to 127"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"uint8"}),(0,s.jsx)(t.td,{children:"1"}),(0,s.jsx)(t.td,{children:"0 to 255"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"int16"}),(0,s.jsx)(t.td,{children:"2"}),(0,s.jsx)(t.td,{children:"-32,768 to 32,767"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"uint16"}),(0,s.jsx)(t.td,{children:"2"}),(0,s.jsx)(t.td,{children:"0 to 65,535"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"int32"}),(0,s.jsx)(t.td,{children:"4"}),(0,s.jsx)(t.td,{children:"-2,147,483,648 to 2,147,483,647"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"uint32"}),(0,s.jsx)(t.td,{children:"4"}),(0,s.jsx)(t.td,{children:"0 to 4,294,967,295"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"float32"}),(0,s.jsx)(t.td,{children:"4"}),(0,s.jsx)(t.td,{children:"3.4E +/- 38 (7 digits)"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"float64"}),(0,s.jsx)(t.td,{children:"8"}),(0,s.jsx)(t.td,{children:"1.7E +/- 308 (15 digits)"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"string"}),(0,s.jsx)(t.td,{children:"varuint length prefix followed by bytes of each character"}),(0,s.jsx)(t.td,{children:"Any string"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"varuint"}),(0,s.jsxs)(t.td,{children:["1 byte when 0 to 127",(0,s.jsx)("br",{})," 2 bytes when 128 to 16,383",(0,s.jsx)("br",{})," 3 bytes when 16,384 to 2,097,151",(0,s.jsx)("br",{})," 4 bytes when 2,097,152 to 268,435,455",(0,s.jsx)("br",{})," etc."]}),(0,s.jsx)(t.td,{children:"0 to 2,147,483,647"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"varint"}),(0,s.jsxs)(t.td,{children:["1 byte when -64 to 63",(0,s.jsx)("br",{})," 2 bytes when -8,192 to 8,191",(0,s.jsx)("br",{})," 3 bytes when -1,048,576 to 1,048,575",(0,s.jsx)("br",{})," 4 bytes when -134,217,728 to 134,217,727",(0,s.jsx)("br",{})," etc."]}),(0,s.jsx)(t.td,{children:"-1,073,741,824 to 1,073,741,823"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"buffer"}),(0,s.jsx)(t.td,{children:"varuint length prefix followed by bytes of buffer"}),(0,s.jsx)(t.td,{children:"Any buffer"})]})]})]}),"\n",(0,s.jsx)(t.h3,{id:"packer",children:"Packer"}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.code,{children:"Packer"})," is a higher-order function that may be used to pack all or part of the packet data\nregardless of the schema (e.g. JSON). ",(0,s.jsx)(t.code,{children:"Packer"})," uses\n",(0,s.jsx)(t.a,{href:"https://github.com/kawanet/msgpack-lite",children:(0,s.jsx)(t.code,{children:"msgpack-lite"})})," to serialize the packet data."]}),"\n",(0,s.jsx)(t.h4,{id:"the-entire-packet",children:"The entire packet"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-javascript",metastring:'title="packages/example/src/packets/anything.js"',children:"export default (flecks) => {\n  const {Packer, Packet} = flecks.fleck('@flecks/socket');\n  const decorator = Packer();\n  return class Anything extends decorator(Packet) {};\n};\n"})}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-javascript",children:"socket.send(['Anything', {foo: 'bar', arbitrary: 'data'}]);\n"})}),"\n",(0,s.jsx)(t.h4,{id:"a-specific-key",children:"A specific key"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-javascript",metastring:'title="packages/example/src/packets/anything-field.js"',children:"export default (flecks) => {\n  const {Packer, Packet} = flecks.fleck('@flecks/socket');\n  const decorator = Packer('document');\n  return class AnythingField extends decorator(Packet) {\n\n    // Notice that we may still define other data fields here.\n    static get data() {\n      return {\n        id: 'uint32',\n      };\n    }\n\n  };\n};\n"})}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-javascript",children:"socket.send([\n  'AnythingField',\n  {\n    document: {whatever: 'you', want: 42},\n    id: 1234567,\n  },\n]);\n"})}),"\n",(0,s.jsxs)(t.p,{children:["Packers ultimately pack to/from binary and are compiled down to the ",(0,s.jsx)(t.code,{children:"buffer"})," data type in the\nschema."]}),"\n",(0,s.jsx)(t.h3,{id:"bundles",children:"Bundles"}),"\n",(0,s.jsxs)(t.p,{children:["A bundle is a bunch of packets that get packed into a single packet. Before you ask, ",(0,s.jsx)(t.strong,{children:"yes"}),", you can\ncreate ",(0,s.jsx)(t.code,{children:"Bundle"}),"s of ",(0,s.jsx)(t.code,{children:"Bundle"}),"s of packets. They're recursive!"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-javascript",children:"const packets = [\n  ['Action', {type: 'SET', payload: 20}],\n  ['Bundle', [\n    ['Action', {type: 'ADD', payload: 23}],\n    ['Action', {type: 'ADD', payload: 26}],\n  ]],\n  // ...\n];\nsocket.send(['Bundle', packets]); // Nice.\n"})}),"\n",(0,s.jsxs)(t.p,{children:["Bundles ultimately pack to/from binary and are compiled down to the ",(0,s.jsx)(t.code,{children:"buffer"})," data type in the\nschema."]}),"\n",(0,s.jsx)(t.h3,{id:"acceptors",children:"Acceptors"}),"\n",(0,s.jsx)(t.p,{children:"Packets are subject to acceptors which validate and respond to packets. Your packets may implement\nacceptor methods:"}),"\n",(0,s.jsx)(t.h4,{id:"validatepacket-socket",children:(0,s.jsx)(t.code,{children:"validate(packet, socket)"})}),"\n",(0,s.jsx)(t.h5,{id:"packet",children:(0,s.jsx)(t.code,{children:"packet"})}),"\n",(0,s.jsx)(t.p,{children:"The packet being validated."}),"\n",(0,s.jsx)(t.h5,{id:"socket",children:(0,s.jsx)(t.code,{children:"socket"})}),"\n",(0,s.jsx)(t.p,{children:"The socket through which was sent the packet being validated."}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.code,{children:"validate"})," acceptor methods may throw ",(0,s.jsx)(t.code,{children:"ValidationError"}),"s which ",(0,s.jsx)(t.code,{children:"@flecks/socket"})," provides:"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-javascript",metastring:'title="src/packets/some-packet.js"',children:"export default (flecks) => {\n  const {Packet, ValidationError} = flecks.fleck('@flecks/socket');\n\n  return class SomePacket extends Packet {\n\n    static async validate(packet, {req}) {\n      if (await req.checkSomething()) {\n        throw new ValidationError({code: 404, reason: 'no something found'});\n      }\n    }\n\n  };\n};\n"})}),"\n",(0,s.jsx)(t.h4,{id:"respondpacket-socket",children:(0,s.jsx)(t.code,{children:"respond(packet, socket)"})}),"\n",(0,s.jsx)(t.h5,{id:"packet-1",children:(0,s.jsx)(t.code,{children:"packet"})}),"\n",(0,s.jsx)(t.p,{children:"The packet being responded to."}),"\n",(0,s.jsx)(t.h5,{id:"socket-1",children:(0,s.jsx)(t.code,{children:"socket"})}),"\n",(0,s.jsx)(t.p,{children:"The socket through which was sent the packet being responded to."}),"\n",(0,s.jsxs)(t.admonition,{title:"Full circle",type:"note",children:[(0,s.jsxs)(t.p,{children:["The result from your ",(0,s.jsx)(t.code,{children:"respond"})," acceptor method is serialized and transmitted and is ultimately the\nresult of socket.send`:"]}),(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-javascript",children:"const result = await socket.send(['Whatever']);\n// result is whatever was returned from the `respond` acceptor method.\n"})})]}),"\n",(0,s.jsx)(t.h4,{id:"examples",children:"Examples"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsxs)(t.p,{children:["The ",(0,s.jsx)(t.code,{children:"@flecks/redux"})," client implements the following ",(0,s.jsx)(t.code,{children:"respond"})," acceptor method:"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-javascript",children:"  static async respond(packet) {\n    flecks.redux.dispatch(packet.data);\n  }\n"})}),"\n",(0,s.jsxs)(t.p,{children:["Whenever the client receives an ",(0,s.jsx)(t.code,{children:"Action"})," packet, the action will be dispatched by\nthe redux store."]}),"\n"]}),"\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.code,{children:"@flecks/passport"})," implements a ",(0,s.jsx)(t.code,{children:"validate"})," acceptor method for the ",(0,s.jsx)(t.code,{children:"Logout"})," packet:"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-javascript",children:"    static validate(packet, {req}) {\n      if (!req.user) {\n        throw new ValidationError({code: 400, reason: 'anonymous'});\n      }\n    }\n"})}),"\n",(0,s.jsxs)(t.p,{children:["If ",(0,s.jsx)(t.code,{children:"req.user"})," doesn't exist, the packet fails validation."]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(t.h2,{id:"intercom",children:"Intercom"}),"\n",(0,s.jsxs)(t.p,{children:["flecks provides ",(0,s.jsx)(t.strong,{children:"intercom"})," as a way for your socket server nodes to communicate amongst\nthemselves. Intercom is provided on a server socket at ",(0,s.jsx)(t.code,{children:"socket.req.intercom"})," and has two\nparameters:"]}),"\n",(0,s.jsx)(t.h3,{id:"type",children:(0,s.jsx)(t.code,{children:"type"})}),"\n",(0,s.jsxs)(t.p,{children:["The type of intercom call to make (e.g. ",(0,s.jsx)(t.code,{children:"@flecks/passport.users"}),")."]}),"\n",(0,s.jsx)(t.h3,{id:"data",children:(0,s.jsx)(t.code,{children:"data"})}),"\n",(0,s.jsx)(t.p,{children:"Arbitrary serializable data to send along with the intercom request."}),"\n",(0,s.jsx)(t.admonition,{title:"Putting the web in websockets",type:"tip",children:(0,s.jsxs)(t.p,{children:["Intercom can also be called from an implementation of ",(0,s.jsx)(t.code,{children:"@flecks/web/server.request.socket"})," through\n",(0,s.jsx)(t.code,{children:"req.intercom"}),"."]})}),"\n",(0,s.jsx)(t.h3,{id:"motivation",children:"Motivation"}),"\n",(0,s.jsxs)(t.p,{children:["Suppose that we are running many game simulation nodes which each have many clients connected. The\nnodes are processing a large number of positions in real time. Clients connected to any\nnode must be able to request a position even if it is simulated on another node. A client connected\nto a node may request a position ",(0,s.jsx)(t.code,{children:"P"}),". A node may efficiently check if it simulates ",(0,s.jsx)(t.code,{children:"P"}),"."]}),"\n",(0,s.jsxs)(t.p,{children:["If the node that dispatches the request simulates the position, the response can be instant.\nOtherwise, the node must use ",(0,s.jsx)(t.strong,{children:"intercom"})," to ask the other nodes whether they simulate ",(0,s.jsx)(t.code,{children:"P"}),":"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-javascript",children:"const responses = await socket.req.intercom('@simulation/position.request', P);\n"})}),"\n",(0,s.jsxs)(t.p,{children:["This asks the other nodes if they simulate ",(0,s.jsx)(t.code,{children:"P"}),". Nodes will respond either with ",(0,s.jsx)(t.code,{children:"undefined"})," or ",(0,s.jsx)(t.code,{children:"P"}),"\nthrough their implementations of ",(0,s.jsx)(t.code,{children:"@flecks/socket.intercom"}),":"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-javascript",children:"export const hooks = {\n  '@flecks/socket.intercom': async (P, {simulation}) => {\n    if (simulation.has(P)) {\n      return simulation.positionOf(P);\n    }\n    // return undefined is implied...\n  },\n}\n"})}),"\n",(0,s.jsx)(t.admonition,{title:"Is that really what I sound like?",type:"note",children:(0,s.jsxs)(t.p,{children:["Intercom ",(0,s.jsx)(t.strong,{children:"will"})," invoke the ",(0,s.jsx)(t.code,{children:"@flecks/socket.intercom"})," implementation of the requesting node, not\nonly the others."]})}),"\n",(0,s.jsx)(t.h3,{id:"diagram",children:"Diagram"}),"\n",(0,s.jsx)(t.mermaid,{value:"  sequenceDiagram\n      actor Client\n      participant Node-1\n      participant Node-2\n      participant Node-N\n      Client->>Node-1: REQUEST: position(P)\n      alt has position(P)\n        Node-1->>Client: RESPONSE: {x, y, z}\n      else doesn't have position(P)\n        Node-1->>Intercom: INTERCOM: @simulation/position.request(P)\n        par\n          Intercom--\x3e>Node-1: INTERCOM: @simulation/position.request(P)\n          Node-1-xIntercom: RESPONSE: undefined\n        and\n          Intercom--\x3e>Node-2: INTERCOM: @simulation/position.request(P)\n          Node-2->>Intercom: RESPONSE: {x, y, z}\n        and\n          Intercom--\x3e>Node-N: INTERCOM: @simulation/position.request(P)\n          Node-N-xIntercom: RESPONSE: undefined\n        end\n        Intercom->>Node-1: RESPONSE: [undefined, {x, y, z}, undefined]\n        Node-1->>Client: RESPONSE: {x, y, z}\n      end"}),"\n",(0,s.jsx)(t.h2,{id:"default-packets",children:"Default packets"}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.code,{children:"@flecks/socket"})," provides some packets by default:"]}),"\n",(0,s.jsx)(t.h3,{id:"refresh",children:(0,s.jsx)(t.code,{children:"Refresh"})}),"\n",(0,s.jsx)(t.p,{children:"Sent to a client, refreshes the page."}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-javascript",children:"socket.send(['Refresh']);\n"})}),"\n",(0,s.jsx)(t.h3,{id:"redirect",children:(0,s.jsx)(t.code,{children:"Redirect"})}),"\n",(0,s.jsxs)(t.p,{children:["Send a string which will be assigned to ",(0,s.jsx)(t.code,{children:"window.location.href"}),"."]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-javascript",children:"socket.send(['Redirect', '/']);\n"})}),"\n",(0,s.jsxs)(t.p,{children:["See ",(0,s.jsx)(t.a,{href:"./flecks/hooks#fleckssocketpackets",children:"the generated hooks page"})," for an exhaustive list of packets."]})]})}function h(e={}){const{wrapper:t}={...(0,a.a)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(o,{...e})}):o(e)}},5162:(e,t,n)=>{n.d(t,{Z:()=>r});n(7294);var s=n(512);const a={tabItem:"tabItem_Ymn6"};var c=n(5893);function r(e){let{children:t,hidden:n,className:r}=e;return(0,c.jsx)("div",{role:"tabpanel",className:(0,s.Z)(a.tabItem,r),hidden:n,children:t})}},4866:(e,t,n)=>{n.d(t,{Z:()=>b});var s=n(7294),a=n(512),c=n(2466),r=n(6550),i=n(469),d=n(1980),l=n(7392),o=n(12);function h(e){return s.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,s.isValidElement)(e)&&function(e){const{props:t}=e;return!!t&&"object"==typeof t&&"value"in t}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function u(e){const{values:t,children:n}=e;return(0,s.useMemo)((()=>{const e=t??function(e){return h(e).map((e=>{let{props:{value:t,label:n,attributes:s,default:a}}=e;return{value:t,label:n,attributes:s,default:a}}))}(n);return function(e){const t=(0,l.l)(e,((e,t)=>e.value===t.value));if(t.length>0)throw new Error(`Docusaurus error: Duplicate values "${t.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[t,n])}function p(e){let{value:t,tabValues:n}=e;return n.some((e=>e.value===t))}function x(e){let{queryString:t=!1,groupId:n}=e;const a=(0,r.k6)(),c=function(e){let{queryString:t=!1,groupId:n}=e;if("string"==typeof t)return t;if(!1===t)return null;if(!0===t&&!n)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return n??null}({queryString:t,groupId:n});return[(0,d._X)(c),(0,s.useCallback)((e=>{if(!c)return;const t=new URLSearchParams(a.location.search);t.set(c,e),a.replace({...a.location,search:t.toString()})}),[c,a])]}function j(e){const{defaultValue:t,queryString:n=!1,groupId:a}=e,c=u(e),[r,d]=(0,s.useState)((()=>function(e){let{defaultValue:t,tabValues:n}=e;if(0===n.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(t){if(!p({value:t,tabValues:n}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${t}" but none of its children has the corresponding value. Available values are: ${n.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return t}const s=n.find((e=>e.default))??n[0];if(!s)throw new Error("Unexpected error: 0 tabValues");return s.value}({defaultValue:t,tabValues:c}))),[l,h]=x({queryString:n,groupId:a}),[j,k]=function(e){let{groupId:t}=e;const n=function(e){return e?`docusaurus.tab.${e}`:null}(t),[a,c]=(0,o.Nk)(n);return[a,(0,s.useCallback)((e=>{n&&c.set(e)}),[n,c])]}({groupId:a}),m=(()=>{const e=l??j;return p({value:e,tabValues:c})?e:null})();(0,i.Z)((()=>{m&&d(m)}),[m]);return{selectedValue:r,selectValue:(0,s.useCallback)((e=>{if(!p({value:e,tabValues:c}))throw new Error(`Can't select invalid tab value=${e}`);d(e),h(e),k(e)}),[h,k,c]),tabValues:c}}var k=n(2389);const m={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var f=n(5893);function v(e){let{className:t,block:n,selectedValue:s,selectValue:r,tabValues:i}=e;const d=[],{blockElementScrollPositionUntilNextRender:l}=(0,c.o5)(),o=e=>{const t=e.currentTarget,n=d.indexOf(t),a=i[n].value;a!==s&&(l(t),r(a))},h=e=>{let t=null;switch(e.key){case"Enter":o(e);break;case"ArrowRight":{const n=d.indexOf(e.currentTarget)+1;t=d[n]??d[0];break}case"ArrowLeft":{const n=d.indexOf(e.currentTarget)-1;t=d[n]??d[d.length-1];break}}t?.focus()};return(0,f.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,a.Z)("tabs",{"tabs--block":n},t),children:i.map((e=>{let{value:t,label:n,attributes:c}=e;return(0,f.jsx)("li",{role:"tab",tabIndex:s===t?0:-1,"aria-selected":s===t,ref:e=>d.push(e),onKeyDown:h,onClick:o,...c,className:(0,a.Z)("tabs__item",m.tabItem,c?.className,{"tabs__item--active":s===t}),children:n??t},t)}))})}function g(e){let{lazy:t,children:n,selectedValue:a}=e;const c=(Array.isArray(n)?n:[n]).filter(Boolean);if(t){const e=c.find((e=>e.props.value===a));return e?(0,s.cloneElement)(e,{className:"margin-top--md"}):null}return(0,f.jsx)("div",{className:"margin-top--md",children:c.map(((e,t)=>(0,s.cloneElement)(e,{key:t,hidden:e.props.value!==a})))})}function y(e){const t=j(e);return(0,f.jsxs)("div",{className:(0,a.Z)("tabs-container",m.tabList),children:[(0,f.jsx)(v,{...e,...t}),(0,f.jsx)(g,{...e,...t})]})}function b(e){const t=(0,k.Z)();return(0,f.jsx)(y,{...e,children:h(e.children)},String(t))}},1151:(e,t,n)=>{n.d(t,{Z:()=>i,a:()=>r});var s=n(7294);const a={},c=s.createContext(a);function r(e){const t=s.useContext(c);return s.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function i(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:r(e.components),s.createElement(c.Provider,{value:t},e.children)}}}]);